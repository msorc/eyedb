<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN" "http://www.oasis-open.org/docbook/xml/4.4/docbookx.dtd"
[
<!ENTITY eyedb "EyeDB">
<!ENTITY eyedbadmin "<command>eyedbadmin</command>">
]
>

<book>
  <title>EyeDB Administration Guide</title>

  <chapter id="database_advanced">
    <title>Database advanced administration</title>
    
    <para>
      This chapter explains &eyedb; databases advanced administration, namely the <emphasis>datafiles</emphasis> and <emphasis>dataspaces</emphasis> concepts that allow to create multi-volumes large &eyedb; databases.
    </para>

    <para>
      The first section describes &eyedb; databases architecture; the following sections deal with datafiles and dataspaces management commands.
    </para>

    <section>
      <title>&eyedb; databases architecture</title>

      <para>
	<itemizedlist>
	  <listitem><para>a database is composed of dataspaces (at least one) and each dataspace is composed of datafiles.</para></listitem>
	  <listitem><para>a datafile is a physical file while a dataspace is a logical unit used to gather datafiles.</para>
	  </listitem>
	</itemizedlist>
      </para>

      <para>
	When you create a database with no options:
	<itemizedlist>
	  <listitem><para>a datafile named DEFAULT, whose file is DBNAME.dat, and size is 2Gb is automatically created</para></listitem>
	  <listitem><para>a dataspace named DEFAULT is automatically created, this dataspace contains the previous datafile</para></listitem>
	</itemizedlist>
      </para>

      <para>
	Then you can add datafiles and dataspaces at any time as follows:
      </para>

      <para>
=> your database is  about 1,2 Tb large
You can list the two dataspaces (the DEFAULT one and DSP1) as follows:
      </para>

      <para>
You can also resize existing datafiles, move them, delete them (if they contains no data) and update dataspaces.
      </para>

    </section>

    <section>
      <title>Managing datafiles</title>

      <para>
	This section describes how to manage datafiles: create, list and delete datafiles, renaming, moving, resizing and defragmenting datafiles.
      </para>

      <section>
	<title>Creating, listing and deleting datafiles</title>

	<para>
	  Creating a datafile is done using the &eyedbadmin; command:
	  <cmdsynopsis>
	    &eyedbadmin;
	    <command>datafile create</command>
	    <arg choice="opt">options</arg>
	    <arg choice="req"><replaceable>database</replaceable></arg>
	    <arg choice="req"><replaceable>datafile</replaceable></arg>
	  </cmdsynopsis>
	</para>

	<para>
	  Options are:
	  <itemizedlist>
	    <listitem>
	      <para>
		<cmdsynopsis>
		  <arg choice="plain">--filedir=<replaceable>directory</replaceable></arg>
		</cmdsynopsis>
		option comment
	      </para>
	    </listitem>
	    <listitem>
	      <para>
		<cmdsynopsis>
		  <arg choice="plain">--name=<replaceable>name</replaceable></arg>
		</cmdsynopsis>
		option comment
	      </para>
	    </listitem>
	    <listitem>
	      <para>
		<cmdsynopsis>
		  <arg choice="plain">--size=<replaceable>size</replaceable></arg>
		</cmdsynopsis>
		option comment
	      </para>
	    </listitem>
	    <listitem>
	      <para>
		<cmdsynopsis>
		  <arg choice="plain">--slotsize=<replaceable>slotsize</replaceable></arg>
		</cmdsynopsis>
		option comment
	      </para>
	    </listitem>
	    <listitem>
	      <para>
		<cmdsynopsis>
		  <arg choice="plain">--physical</arg>
		</cmdsynopsis>
		option comment
	      </para>
	    </listitem>
	  </itemizedlist>
	</para>

	<para>
	  Command arguments are:
	  <itemizedlist>
	    <listitem>
	      <para>
		<cmdsynopsis>
		  <arg choice="req"><replaceable>database</replaceable></arg>
		</cmdsynopsis>
		the database to which the datafile will be attached
	      </para>
	    </listitem>
	    <listitem>
	      <para>
		<cmdsynopsis>
		  <arg choice="req"><replaceable>datafile</replaceable></arg>
		</cmdsynopsis>
		the datafile name (.dat file name extension is recommended)
	      </para>
	    </listitem>
	  </itemizedlist>
	</para>

	<example id="eyedbadmin-datafile-create">
	  <title>&eyedbadmin; datafile create</title>
	  <screen>
	    # creating 4 datafiles 300Gb size
	    eyedbadmin datafile create --size=300000 foo foo0.dat
	    eyedbadmin datafile create --size=300000 foo foo1.dat
	    eyedbadmin datafile create --size=300000 foo foo2.dat
	    eyedbadmin datafile create --size=300000 foo foo3.dat
	  </screen>
	</example>

	<para>
	  The list of the datafiles associated with a database can be obtained using the &eyedbadmin; command:
	  <cmdsynopsis>
	    &eyedbadmin;
	    <command>datafile list</command>
	    <arg choice="opt">options</arg>
	    <arg choice="req"><replaceable>database</replaceable></arg>
	    <arg choice="req"><group><arg choice="req"><replaceable>datafile_id</replaceable></arg><arg choice="req"><replaceable>datafile_name</replaceable></arg></group></arg>
	  </cmdsynopsis>
	</para>

	<para>
	  Options are:
	  <itemizedlist>
	    <listitem>
	      <para>
		<cmdsynopsis>
		  <arg choice="plain">--all</arg>
		</cmdsynopsis>
		list all informations about datafile
	      </para>
	    </listitem>
	    <listitem>
	      <para>
		<cmdsynopsis>
		  <arg choice="plain">--stats</arg>
		</cmdsynopsis>
		list only statistics on datafile
	      </para>
	    </listitem>
	  </itemizedlist>
	</para>

	<para>
	  Command arguments are:
	  <itemizedlist>
	    <listitem>
	      <para>
		<cmdsynopsis>
		  <arg choice="req"><replaceable>database</replaceable></arg>
		</cmdsynopsis>
		the database to which the datafile belongs
	      </para>
	    </listitem>
	    <listitem>
	      <para>
		<cmdsynopsis>
		  <arg choice="req"><group><arg choice="req"><replaceable>datafile_id</replaceable></arg><arg choice="req"><replaceable>datafile_name</replaceable></arg></group></arg>
		</cmdsynopsis>
		the datafile to be deleted, that can be specified either by its id (a number) or by its name
	      </para>
	    </listitem>
	  </itemizedlist>
	</para>

	<example id="eyedbadmin-datafile-list">
	  <title>&eyedbadmin; datafile list</title>
	  <screen>
	  </screen>
	</example>


	<para>
	  Deleting a datafile is done using the &eyedbadmin; command:
	  <cmdsynopsis>
	    &eyedbadmin;
	    <command>datafile delete</command>
	    <arg choice="req"><group><arg choice="req"><replaceable>datafile_id</replaceable></arg><arg choice="req"><replaceable>datafile_name</replaceable></arg></group></arg>
	  </cmdsynopsis>
	</para>

	
	<para>
	  Command arguments are:
	  <itemizedlist>
	    <listitem>
	      <para>
		<cmdsynopsis>
		  <arg choice="req"><replaceable>database</replaceable></arg>
		</cmdsynopsis>
		the database to which the datafile belongs
	      </para>
	    </listitem>
	    <listitem>
	      <para>
		<cmdsynopsis>
		  <arg choice="req"><group><arg choice="req"><replaceable>datafile_id</replaceable></arg><arg choice="req"><replaceable>datafile_name</replaceable></arg></group></arg>
		</cmdsynopsis>
		the datafile to be deleted, that can be specified either by its id (a number) or by its name
	      </para>
	    </listitem>
	  </itemizedlist>
	</para>

	<example id="eyedbadmin-datafile-delete">
	  <title>&eyedbadmin; datafile delete</title>
	  <screen>
	  </screen>
	</example>


      </section>

      <section id="eyedbadmin-datafile-rename">
	<title>renaming and moving datafiles</title>

	<para>
	  ... is done using the &eyedbadmin; command:
	  <cmdsynopsis>
	    &eyedbadmin;
	    <command>...</command>
	    <arg choice="opt">options</arg>
	    <arg choice="req"><replaceable>arg</replaceable></arg>
	  </cmdsynopsis>
	</para>

      <example id="eyedbadmin-dataspace-list">
	<title>&eyedbadmin; dataspace list</title>
	<screen>
eyedbadmin dataspace list foo
	</screen>
      </example>

      </section>

      <section>
	<title>Resizing and defragmenting datafiles</title>

	<para>
	</para>

      </section>

    </section>

    <section>
      <title>Managing dataspaces</title>

      <section>
	<title>Creating, updating and deleting dataspaces</title>

	<example id="eyedbadmin-dataspace-create">
	  <title>&eyedbadmin; dataspace create</title>
	  <screen>
# creating a dataspace gathering those 4 datafiles
eyedbadmin dataspace create foo DSP1 1 2 3
	  </screen>
	</example>

      </section>

      <section>
	<title>Listing and renaming dataspaces</title>

	<para>
	</para>

      </section>

      <section>
	<title>Setting current dataspace and current datafile</title>

	<para>
	</para>

      </section>

    </section>

  </chapter>

<!--
;;; Local Variables: ***
;;; eval: (load-file "emacs-macro") ***
;;; End: ***
-->

</book>
